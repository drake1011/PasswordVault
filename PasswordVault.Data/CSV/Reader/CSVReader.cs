using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

/*=================================================================================================
DESCRIPTION
*================================================================================================*/
/* 
 ------------------------------------------------------------------------------------------------*/

namespace PasswordVault.Data
{
    /*=================================================================================================
	ENUMERATIONS
	*================================================================================================*/

    /*=================================================================================================
	STRUCTS
	*================================================================================================*/

    /*=================================================================================================
	CLASSES
	*================================================================================================*/
    public class CSVReader : ICSVReader, IDisposable
    {
        /*=================================================================================================
		CONSTANTS
		*================================================================================================*/
        /*PUBLIC******************************************************************************************/

        /*PRIVATE*****************************************************************************************/

        /*=================================================================================================
		FIELDS
		*================================================================================================*/
        /*PUBLIC******************************************************************************************/

        /*PRIVATE*****************************************************************************************/
        private StreamReader _streamReader;

        /*=================================================================================================
		PROPERTIES
		*================================================================================================*/
        /*PUBLIC******************************************************************************************/

        /*PRIVATE*****************************************************************************************/

        /*=================================================================================================
		CONSTRUCTORS
		*================================================================================================*/
        public CSVReader()
        {

        }

        ~CSVReader()
        {
            // Finalizer calls Dispose(false)
            Dispose(false);
        }

        /*=================================================================================================
		PUBLIC METHODS
		*================================================================================================*/
        /*************************************************************************************************/
        public void Initialize(string fileName)
        {
            if (File.Exists(fileName))
            {
                _streamReader = new StreamReader(fileName);
            }
        }

        /*************************************************************************************************/
        public void Close()
        {
            if (_streamReader != null)
            {
                _streamReader.Close();
            }
        }

        /*************************************************************************************************/
        public string ReadLine()
        {
            if (_streamReader != null)
            {
                return _streamReader.ReadLine();
            }
            else
            {
                return "";
            }
        }

        public void Dispose()
        {      
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        /*=================================================================================================
		PRIVATE METHODS
		*================================================================================================*/
        /*************************************************************************************************/
        protected virtual void Dispose(bool disposing)
        {
            if (disposing)
            {
                if (_streamReader != null)
                {
                    _streamReader.Dispose();
                    _streamReader = null;
                }
            }        
        }

        /*=================================================================================================
		STATIC METHODS
		*================================================================================================*/
        /*************************************************************************************************/

    } // CSVReader CLASS
} // PasswordVault.Data NAMESPACE
