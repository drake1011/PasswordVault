using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

/*=================================================================================================
DESCRIPTION
*================================================================================================*/
/* 
 ------------------------------------------------------------------------------------------------*/
 
namespace PasswordVault
{
	/*=================================================================================================
	ENUMERATIONS
	*================================================================================================*/
		
	/*=================================================================================================
	STRUCTS
	*================================================================================================*/
	
	/*=================================================================================================
	CLASSES
	*================================================================================================*/
    class PasswordUIFormatter : IPasswordUIFormatter
    {
        /*=================================================================================================
		CONSTANTS
		*================================================================================================*/
        /*PUBLIC******************************************************************************************/

        /*PRIVATE*****************************************************************************************/

        /*=================================================================================================
		FIELDS
		*================================================================================================*/
        /*PUBLIC******************************************************************************************/

        /*PRIVATE*****************************************************************************************/
        IEncryptDecrypt _encryptDecrypt;
        private string _key;

        /*=================================================================================================
		PROPERTIES
		*================================================================================================*/
        /*PUBLIC******************************************************************************************/
        public string Key
        {
            set
            {
                _key = value;
            }
        }

        /*PRIVATE*****************************************************************************************/

        /*=================================================================================================
		CONSTRUCTORS
		*================================================================================================*/
        public PasswordUIFormatter(IEncryptDecrypt encryptDecrypt)
		{
            _encryptDecrypt = encryptDecrypt;
        }

        /*=================================================================================================
		PUBLIC METHODS
		*================================================================================================*/
        /*************************************************************************************************/
        public Password PasswordServiceToUI(Password servicePassword)
        {
            Password uiPassword = null;

            if (_key != "" && _key != null)
            {
                uiPassword = new Password(
                    _encryptDecrypt.Decrypt(servicePassword.Application, _key),
                    _encryptDecrypt.Decrypt(servicePassword.Username, _key),
                    _encryptDecrypt.Decrypt(servicePassword.Description, _key),
                    _encryptDecrypt.Decrypt(servicePassword.Website, _key),
                    servicePassword.Username);
            }

            return uiPassword;
        }

        /*************************************************************************************************/
        public Password PasswordUIToService(Password uiPassword)
        {
            Password servicePassword = null;

            if (_key != "" && _key != null)
            {
                uiPassword = new Password(
                    _encryptDecrypt.Encrypt(servicePassword.Application, _key),
                    _encryptDecrypt.Encrypt(servicePassword.Username, _key),
                    _encryptDecrypt.Encrypt(servicePassword.Description, _key),
                    _encryptDecrypt.Encrypt(servicePassword.Website, _key),
                    _encryptDecrypt.Encrypt(servicePassword.Username, _key));
            }

            return servicePassword;
        }

        /*=================================================================================================
		PRIVATE METHODS
		*================================================================================================*/
        /*************************************************************************************************/

        /*=================================================================================================
		STATIC METHODS
		*================================================================================================*/
        /*************************************************************************************************/

    } // PasswordUIFormatter CLASS
} // PasswordVault NAMESPACE
